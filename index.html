<!DOCTYPE html>
<html lang="da">
    <head>
        <title>Epidemiological Modelling | SEIRS</title>
        <meta charset="utf-8">
        <link rel="stylesheet" href="assets/css/main.css">
        <!-- Using google APIs font -->
        <link href="https://fonts.googleapis.com/css?family=Crimson+Text|Work+Sans:400,700" rel="stylesheet">
        <!-- Icon in browser tab -->
        <link rel="icon" href="images/aau_icon.png">
        <!-- Chart.js API link -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3"></script>
        <!-- Not working Chart.js Zoom plugin -->
        <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@0.7.7"></script>
        <!-- Math API typography link -->
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </head>
    <body>
        <div id="outerDiv">
            <!-- Header and text -->
            <div id="tekst">
                <h1 id="title1">Epidemiological Modelling</h1>
                <h2 id="titledes">SEIRS Compartmental Model
                </h2>
            </div>
            <!-- Inserts chart/graph with questionmark -->
            <div id="left-container">
                <div class="chart">
                    <!-- Questionmark -->
                    <h2><div class="tooltip" id="graphHelp">?
                        <span class="tooltiptext" id="graphHelpSpan">Here you can click on the boxes to remove/show them on the graph.</span>
                    </div></h2>
                    <!-- Inserting the chart -->
                    <canvas id="seirsChart"></canvas>
                </div>
                <!-- Slider and input boxes -->
                <h2 class="titles">Parameters
                <div class="tooltip">?
                    <span class="tooltiptext">Here you can change all the parameters for the model. The graph updates on a input.<br>Move the slider or type in a specific number.</span>
                </div></h2> 
                <text id="error"></text>
                <div class="sliderDiv">
                    <div class="sliderBoxes">
                        <div class="sliderBox">
                            <p class="sliderTitle" id="S0Title"></p>
                            <p class="sliderDes" id="S0Des"></p>
                            <p class="sliderDes" id="S0Checkbox"> 
                            <input type="checkbox" id="fixedPopulation" class="checkbox" name="fixedPopulation" value="" onchange="fixedPopulation()">Fixed Population</p>
                            <input id="S0Form1" class="inputForm" type="number" min="0" max="10000000" maxlength="3" value="99000">
                            <input id="S0Slider1" class="slider" type="range" min="0" max="10000000" maxlength="3" value="99000" step="1">
                        </div>
                        <div class="sliderBox">
                            <p class="sliderTitle">Initial Exposed (E<span class="sub">0</span>)</p>
                            <p class="sliderDes">Amount of people who are exposed but not infectious.</p>
                            <input id="E0Form1" class="inputForm" type="number" min="0" max="100000" maxlength="3" value="0">
                            <input id="E0Slider1" class="slider" type="range" min="0" max="100000" maxlength="3" value="0">
                        </div>
                        <div class="sliderBox">
                            <p class="sliderTitle">Initial Infected (I<span class="sub">0</span>)</p>
                            <p class="sliderDes">Amount of people who are infected and infectious.</p>
                            <input id="I0Form1" class="inputForm" type="number" min="0" max="100000" maxlength="3" value="1000">
                            <input id="I0Slider1" class="slider" type="range" min="0" max="100000" maxlength="3" value="1000">
                        </div>
                        <div class="sliderBox">
                            <p class="sliderTitle">Initial Removed (R<span class="sub">0</span>)</p>
                            <p class="sliderDes">Amount of people who has either recovered from the disease or who are deceased.</p>
                            <input id="R0Form1" class="inputForm" type="number" min="0" max="100000" maxlength="3" value="0">
                            <input id="R0Slider1" class="slider" type="range" min="0" max="100000" maxlength="3" value="0">
                        </div>
                        <div class="sliderBox">
                            <p class="sliderTitle">Beta</p>
                            <p class="sliderDes">\(\beta\) determines the rate of spread.</p>
                            <input id="betaForm1" class="inputForm" type="number" min="0." max="5" value="0.02">
                            <input id="betaSlider1" class="slider" type="range" min="0." max="5" value="0.02" step="0.001">
                        </div>
                        <div class="sliderBox">
                            <p class="sliderTitle">Gamma</p>
                            <p class="sliderDes">\(\gamma\) determines the rate at which individuals recover.</p>
                            <input id="gammaForm1" class="inputForm" type="number" min="0." max="0.5" maxlength="10000000" value="0.0006">
                            <input id="gammaSlider1" class="slider" type="range" min="0." max="0.5" maxlength="10000000" value="0.0006" step="0.00001">
                        </div>
                        <div class="sliderBox">
                            <p class="sliderTitle">Epsilon</p>
                            <p class="sliderDes">\(\epsilon\) determines the rate of recovered individuals returning to susceptible.</p>
                            <input id="epsForm1" class="inputForm" type="number" min="0" max="0.1" value="0.02">
                            <input id="epsSlider1" class="slider" type="range" min="0" max="0.1" value="0.02" step="0.00001">
                        </div>
                        <div class="sliderBox">
                            <p class="sliderTitle">Sigma</p>
                            <p class="sliderDes">\(\sigma\) determines the rate of individuals who are exposed becoming infectious.</p>
                            <input id="sigForm1" class="inputForm" type="number" min="0" max="0.2" maxlength="10000000" value="0.0006">
                            <input id="sigSlider1" class="slider" type="range" min="0" max="0.2" maxlength="10000000" value="0.0006" step="0.00001">
                        </div>
                    </div>
                </div>
                <div class="sliderBoxTall">
                    <div class="sliderBox" id="daysBox">
                        <p class="sliderTitle">Days</p>
                        <p class="sliderDes" id="daysDes">Total number of days. <br><br> 
                            Runge-kutta 4th order is used to approximate the measurements. <br><br> 
                            Step size = 0,01 <br>
                            <text id="totalSteps"></text> <br><br> 
                            Move the slider or type in the specific number of days below.
                        </p>
                        <input id="totalStepForm1" class="inputForm"  type="number" min="1" max="1000" value="100">
                        <input id="totalStepSlider1" class="slider" type="range" min="1" max="1000" value="100" step="1">
                    </div>
                </div>    

                <!-- Former Diseases Table 
                <h2>Former Diseases</h2>
                <table class="diseasesTable">
                    <tr>
                        <th>Disease</th>
                        <th>Parameters</th>
                        <th>Show on graph</th>
                        <th>Source</th>
                    </tr>
                </table>-->
                
                <!-- SEIRS Model Explanation -->
                <h2 class="titles">The SEIRS Compartmental Model</h2>
                <p class="mathText">The SEIRS models ordinary differential equations are:</p><br>
                <text class="mathFunc">\( {dS \over dt} = -{\beta SI \over N} + \epsilon R, \)</text>
                <text class="mathFunc">\( {dE \over dt} = {\beta IS \over N} - \sigma E,  \)</text>
                <text class="mathFunc">\( {dI \over dt} = \sigma E - \gamma I, \)</text>
                <text class="mathFunc">\( {dR \over dt} = \gamma I - \epsilon R \)</text>
                <br><br>
                <p class="mathText"><em>where</em></p><br>
                <p class="mathText">\(S\) is the number of susceptible individuals.</p>
                <p class="mathText">\(E\) is the number of exposed individuals.</p>
                <p class="mathText">\(I\) is the number of infected individuals.</p>
                <p class="mathText">\(R\) is the number of removed individuals.</p>
                <p class="mathText">\(\beta\) is the infectious rate.</p>                   
                <p class="mathText">\(\sigma\) is the incubation rate.</p>
                <p class="mathText">\(\gamma\) is the recovery rate.</p>
                <p class="mathText">\(\epsilon\) is the rate which recovered individuals return to the susceptible statue due to loss of immunity.</p> 
                
                <h2 class="titles">Runge-kutta 4th Order</h2>
                <p class="mathText">Consider the following initial value problem of ODE</p><br>
                <text class="mathFunc">\({dy \over dt} = f(t, y), y(t_0) = y_0\)</text><br><br>
                <p class="mathText">The iterative formula of RK4 method for solving the ODE above is as follows</p>
                <p class="mathFunc">\(y_n+1 = y_n + {\Delta t \over 6} (k_1 + 2k_2 + 2k_3 + k_4) \)</p>
                <text class="mathFunc">\(k_1 = f(t_n, y_n), \)</text>
                <text class="mathFunc">\(k_2 = f(t_n + {\Delta t \over 2}, y_n + + {k_1\Delta t \over 2}), \)</text>
                <text class="mathFunc">\(k_3 = f(t_n + {\Delta t \over 2}, y_n + + {k_2\Delta t \over 2}), \)</text>
                <text class="mathFunc">\(k_4 = f(t_n + \Delta t, y_n + k_3 \Delta t) \)</text>
                <p class="mathFunc">\(t_n + 1 = t_n + \Delta t \)</p>
                <text class="mathFunc">\(n = 0, 1, 2, 3, ...\)</text>
                <br><br>
                <h2 id="infoTitle">Help</h2>
                <!-- Clear Cookies button -->
                <p class="mathText">If you have any problems or just want to reset everything, press this button.<button id="clearCookiesButton" onclick="clearCookies()">Clear Cookies</button></p>
                
                <!-- Trigger/Open The Modal -->
                <p class="mathText">Press on this button to show the popup message again.<button id="guideBtn" onclick="showPopup()">Start Guide</button></p>
                <br>                
            </div>
            <div id="right-container">
                <h2 id="infoTitle">Information
                    <div class="tooltip">?
                        <span class="tooltiptext">Here you can see information about the chart. It updates with the chart itself.</span>
                    </div>
                </h2>

                <!-- Infomation table -->
                <table class="infoTable">
                    <tr>
                        <th>Total Population (N)</th>
                        <td id="totalPopulation"></td>
                    </tr>
                    <tr>
                        <th>Peak Infected</th>
                        <td id="maxInfected"></td>
                    </tr>
                    <tr>
                        <th>Peak Exposed</th>
                        <td id="maxExposed"></td>
                    </tr>

                </table>
                <!-- Reset button -->
                <button id="resetButton" onclick="resetGraph()">Reset graph</button>
                <text id="confirmReset"></text>

                <!-- Save to CSV file button -->
                <h2 class="titles">Download Data
                <div class="tooltip">?
                    <span class="tooltiptext">Click on the button below to download the current results to a CSV file.</span>
                </div></h2>
                <button onclick="saveCSV()">Save data to CSV</button>
                
                <!-- Saved parameters table -->
                <h2 class="titles">Save Parameters
                <div class="tooltip">?
                    <span class="tooltiptext">Here you can save your current parameters. These are only available on this device.</span>
                </div></h2>
                <input id="savedName" type="text" placeholder="File name" name="savedName" maxlength="30" value="">
                <button id="savedBtn" onclick="saveParameters()">Save Parameters</button>
                <table id="savedParametersTable" class="savedTable">
                    <!-- Size of each colum in the table -->
                    <colgroup>
                        <col span="1" style="width: 20%;">
                        <col span="1" style="width: 23%;">
                        <col span="1" style="width: 20%;">
                        <col span="1" style="width: 5%;">
                     </colgroup>
                    <tr>
                        <th>File Name</th>
                        <th>Saved Date</th>
                        <th>Load Parameters</th>
                        <th>Delete</th>
                    </tr>
                </table>
            </div>
        </div>
        


        <!-- The Modal / Popup Welcome Message -->
        <div id="guideBox" class="modal">
            <!-- Modal content -->
            <div class="modal-content">
                <span class="close">&times;</span>
                <h1>Welcome</h1>
                <p class="modalText">This website has been developed by a group of 2nd semester Software students from Aalborg University, 
                    for the purpose of creating a tool that can aid experts with controlling the spread of ongoing epidemics.
                    Additionally, the purpose of the website is to fulfill the curriculum requirements of the current semester.</p>
                <h1>About the website</h1>
                <p class="modalText">The modelling of infectious diseases is a tool that can be used to study the mechanisms by which diseases spread, 
                    to predict the future course of an outbreak, and to evaluate strategies to control an epidemic.
                    The world is currently in the midst of the COVID-19 pandemic, which makes it even more crucial to have access to a tool like this.</p>
                <h1>Help</h1>
                <p class="modalText">At most titles you will see a <a class="tooltip">?<span class="tooltiptext">Hover me, to be shown a short explanation.</span></a>, 
                    which you can hover over to get a short explanation for the section. And at the buttom of the webpage, the is also a explanation to the model used 
                    and its differential equations. <br>
                    The website works best on a computer with a 1920x1080 resolution or higher.</p>
                <h1>Created by</h1>
                <p class="modalText">Andreas Løvig Borg <br>Elias Davidsen <br>Lasse Ryge Andersen <br>Marius Ihlen Gardshodn <br>Mikkel Hagerup Dolmer</p>
                <em class="modalText">Last updated on May 7, 2021</em>
            </div>
        </div>

        <script src="assets/js/slider_inputs.js"></script>
        <script src="assets/js/cookies.js"></script>
        <script src="assets/js/main.js"></script>
        <script src="assets/js/modal.js"></script>
        <script src="assets/js/set_values.js"></script>
        <script src="assets/js/save.js"></script>
    </body>
</html>
